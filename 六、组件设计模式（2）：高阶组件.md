# å…­ã€ç»„ä»¶è®¾è®¡æ¨¡å¼ï¼ˆ2ï¼‰ï¼šé«˜é˜¶ç»„ä»¶

### 1.é«˜é˜¶ç»„ä»¶çš„åŸºæœ¬å½¢å¼ï¼š

- é«˜é˜¶ç»„ä»¶åå­—â€œç»„ä»¶â€ï¼Œå…¶å®žä¸æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œè€Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆFuncï¼‰
  - ðŸ™å‚æ•°ï¼šæŽ¥æ”¶è‡³å°‘ä¸€ä¸ªReactä½œä¸ºå‚æ•°
  - ðŸ¦žè¿”å›žå€¼ï¼šè¿”å›žä¸€ä¸ªå…¨æ–°çš„Reactä½œä¸ºç»“æžœ
  - ðŸ¡ç†è§£ï¼šæ–°äº§ç”Ÿçš„ React ç»„ä»¶æ˜¯å¯¹ä½œä¸ºå‚æ•°çš„ç»„ä»¶çš„åŒ…è£…ï¼Œæ‰€ä»¥ï¼Œæœ‰æœºä¼šèµ‹äºˆæ–°ç»„ä»¶ä¸€äº›å¢žå¼ºçš„â€œç¥žåŠ›â€ã€‚

ä¸€ä¸ªå•¥éƒ½ä¸åšçš„é«˜é˜¶ç»„ä»¶çš„ä¾‹å­ðŸŒ°ï¼š

```react
const withDoNothing = (Component) => {
  const NewComponent = (props) => {
    return <Component {...props} />;
  };
  return NewComponent;
};
```

ðŸ¥æ³¨æ„äº‹é¡¹:

- é«˜é˜¶ç»„ä»¶çš„å‘½åï¼š
  - é«˜é˜¶ç»„ä»¶çš„å‘½åä¸€èˆ¬éƒ½å¸¦ `with` å‰ç¼€
  - å‘½åä¸­åŽé¢çš„éƒ¨åˆ†ä»£è¡¨è¿™ä¸ªé«˜é˜¶ç»„ä»¶çš„åŠŸèƒ½
- **é«˜é˜¶ç»„ä»¶ä¸èƒ½åŽ»ä¿®æ”¹ä½œä¸ºå‚æ•°çš„ç»„ä»¶ï¼Œé«˜é˜¶ç»„ä»¶å¿…é¡»æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œä¸åº”è¯¥æœ‰ä»»ä½•å‰¯ä½œç”¨**ã€‚
- é«˜é˜¶ç»„ä»¶**è¿”å›žçš„ç»“æžœå¿…é¡»æ˜¯ä¸€ä¸ªæ–°çš„ React ç»„ä»¶**ï¼Œè¿™ä¸ªæ–°çš„ç»„ä»¶çš„ JSX éƒ¨åˆ†è‚¯å®šä¼šåŒ…å«ä½œä¸ºå‚æ•°çš„ç»„ä»¶ã€‚
- **é«˜é˜¶ç»„ä»¶ä¸€èˆ¬éœ€è¦æŠŠä¼ ç»™è‡ªå·±çš„ props è½¬æ‰‹ä¼ é€’ç»™ä½œä¸ºå‚æ•°çš„ç»„ä»¶ã€‚**ï¼ˆåŒªå¤·æ‰€æ€å“ˆå“ˆå“ˆï¼‰



### 2.ç”¨é«˜é˜¶ç»„ä»¶æŠ½å–å…±åŒé€»è¾‘ï¼š

å‡è®¾æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªå‡½æ•° `getUserId` èƒ½å¤Ÿä»Ž cookies ä¸­è¯»å–ç™»å½•ç”¨æˆ·çš„ IDï¼Œå¦‚æžœç”¨æˆ·æœªç™»å½•ï¼Œè¿™ä¸ª `getUserId` å°±è¿”å›žç©ºï¼Œé‚£ä¹ˆâ€œé€€å‡ºç™»å½•æŒ‰é’®â€œå°±éœ€è¦è¿™ä¹ˆå†™ï¼š

```react
const LogoutButton = () => {
  if (getUserId()) {
    return ...; // æ˜¾ç¤ºâ€é€€å‡ºç™»å½•â€œçš„JSX
  } else {
    return null;
  }
};
```

åŒæ ·ï¼Œè´­ç‰©è½¦çš„ä»£ç å°±æ˜¯è¿™æ ·ï¼š

```react
const ShoppintCart = () => {
  if (getUserId()) {
    return ...; // æ˜¾ç¤ºâ€è´­ç‰©è½¦â€œçš„JSX
  } else {
    return null;
  }
};
```

ä¸Šé¢ä¸¤ä¸ªç»„ä»¶æ˜Žæ˜¾æœ‰é‡å¤çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé‡å¤ä»£ç æŠ½å–å‡ºæ¥ï¼Œå½¢æˆ `withLogin` è¿™ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š

```react
const withLogin = (Component) => {
  const NewComponent = (props) => {
    if (getUserId()) {
      return <Component {...props} />;
    } else {
      return null;
    }
  }
  return NewComponent;
};
```

- ðŸ¡ä¼šæ»‹ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆè¦ä¼ å…¥â€œ{...props}â€ï¼Ÿ
  - ç›®å‰å‘çŽ°å°±æ˜¯å½“è¿™ä¸ªè¿”å›žçš„æ–°ç»„ä»¶NewComponentè¢«ä½¿ç”¨ä¸”ä¼ å…¥å±žæ€§çš„æ—¶å€™ï¼Œèƒ½å¤Ÿè®©è¿™ä¸ªå‚æ•°ç»„ä»¶Componentå†…ä¹Ÿèƒ½å¤Ÿä½¿ç”¨â€œä¼ å…¥çš„å±žæ€§â€ã€‚



ðŸ¤– å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±åªéœ€è¦è¿™æ ·å®šä¹‰ `LogoutButton` å’Œ `ShoppintCart`ï¼š

```react
const LogoutButton = withLogin((props) => {
  return ...; // æ˜¾ç¤ºâ€é€€å‡ºç™»å½•â€œçš„JSX
});

const ShoppingCart = withLogin(() => {
  return ...; // æ˜¾ç¤ºâ€è´­ç‰©è½¦â€œçš„JSX
});
```



### 3.é«˜é˜¶ç»„ä»¶çš„é«˜çº§ç”¨æ³•:

é«˜é˜¶ç»„ä»¶åªéœ€è¦è¿”å›žä¸€ä¸ª React ç»„ä»¶å³å¯ï¼Œæ²¡äººè§„å®šé«˜é˜¶ç»„ä»¶åªèƒ½æŽ¥å—ä¸€ä¸ª React ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå®Œå…¨å¯ä»¥ä¼ å…¥å¤šä¸ª React ç»„ä»¶ç»™é«˜é˜¶ç»„ä»¶ã€‚

ðŸŒµä¸Šé¢ä»£ç çš„æ”¹è¿›ï¼š

```react
const withLoginAndLogout = (ComponentForLogin, ComponentForLogout) => {
  const NewComponent = (props) => {
    if (getUserId()) {
      return <ComponentForLogin {...props} />;
    } else {
      return <ComponentForLogout {...props} />;
    }
  }
  return NewComponent;
};
```

æœ‰äº†ä¸Šé¢çš„ `withLoginAndLogout`ï¼Œå°±å¯ä»¥äº§ç”Ÿæ ¹æ®ç”¨æˆ·ç™»å½•çŠ¶æ€æ˜¾ç¤ºä¸åŒçš„å†…å®¹ã€‚

```react
const TopButtons = withLoginAndLogout(
  LogoutButton,
  LoginButton
);
```



### 4.é“¾å¼è°ƒç”¨é«˜é˜¶ç»„ä»¶:

å‡è®¾ï¼Œä½ æœ‰ä¸‰ä¸ªé«˜é˜¶ç»„ä»¶åˆ†åˆ«æ˜¯ `withOne`ã€`withTwo` å’Œ `withThree`ï¼Œé‚£ä¹ˆï¼Œå¦‚æžœè¦èµ‹äºˆä¸€ä¸ªç»„ä»¶ X æŸä¸ªé«˜é˜¶ç»„ä»¶çš„è¶…èƒ½åŠ›ï¼Œé‚£ä¹ˆï¼Œä½ è¦åšçš„å°±æ˜¯æŒ¨ä¸ªä½¿ç”¨é«˜é˜¶ç»„ä»¶åŒ…è£…ï¼Œä»£ç å¦‚ä¸‹ï¼š

```react
const X1 = withOne(X);
const X2 = withTwo(X1);
const X3 = withThree(X2);
const SuperX = X3; // æœ€ç»ˆçš„SuperXå…·å¤‡ä¸‰ä¸ªé«˜é˜¶ç»„ä»¶çš„è¶…èƒ½åŠ›
```

å¯ä»¥ç›´æŽ¥ï¼š

```react
const SuperX = withThree(withTwo(withOne(X)));
```

å¯¹äºŽ `X` è€Œè¨€ï¼Œå®ƒè¢«é«˜é˜¶ç»„ä»¶åŒ…è£…äº†ï¼Œè‡³äºŽè¢«ä¸€ä¸ªé«˜é˜¶ç»„ä»¶åŒ…è£…ï¼Œè¿˜æ˜¯è¢« N ä¸ªé«˜é˜¶ç»„ä»¶åŒ…è£…ï¼Œæ²¡æœ‰ä»€ä¹ˆå·®åˆ«ã€‚è€Œé«˜é˜¶ç»„ä»¶æœ¬èº«å°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œçº¯å‡½æ•°æ˜¯å¯ä»¥ç»„åˆä½¿ç”¨çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å…¶å®žå¯ä»¥æŠŠå¤šä¸ªé«˜é˜¶ç»„ä»¶ç»„åˆä¸ºä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œç„¶åŽç”¨è¿™ä¸€ä¸ªé«˜é˜¶ç»„ä»¶åŽ»åŒ…è£…`X`ï¼Œä»£ç å¦‚ä¸‹ï¼š

```react
const hoc = compose(withThree, withTwo, withOne);
const SuperX = hoc(X);
```

åœ¨ä¸Šé¢ä»£ç ä¸­ä½¿ç”¨çš„ `compose`ï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­å¾ˆåŸºç¡€çš„ä¸€ç§æ–¹æ³•ï¼Œä½œç”¨å°±æ˜¯æŠŠå¤šä¸ªå‡½æ•°ç»„åˆä¸ºä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å¾ˆå¤šå¼€æºçš„ä»£ç åº“ä¸­éƒ½å¯ä»¥çœ‹åˆ°ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå‚è€ƒå®žçŽ°ï¼š

```react
export default function compose(...funcs) {
  if (funcs.length === 0) {
    return arg => arg
  }

  if (funcs.length === 1) {
    return funcs[0]
  }
  return funcs.reduce((a, b) => (...args) => a(b(...args)))
}
```



### 5.ä¸è¦æ»¥ç”¨é«˜é˜¶ç»„ä»¶

ðŸ–æ³¨æ„äº‹é¡¹ï¼š

- é¦–å…ˆï¼Œé«˜é˜¶ç»„ä»¶ä¸å¾—ä¸å¤„ç† `displayName`ï¼Œä¸ç„¶ debug ä¼šå¾ˆç—›è‹¦ã€‚å½“ React æ¸²æŸ“å‡ºé”™çš„æ—¶å€™ï¼Œé ç»„ä»¶çš„ displayName é™æ€å±žæ€§æ¥åˆ¤æ–­å‡ºé”™çš„ç»„ä»¶ç±»ï¼Œè€Œé«˜é˜¶ç»„ä»¶æ€»æ˜¯åˆ›é€ ä¸€ä¸ªæ–°çš„ React ç»„ä»¶ç±»ï¼Œæ‰€ä»¥ï¼Œæ¯ä¸ªé«˜é˜¶ç»„ä»¶éƒ½éœ€è¦å¤„ç†ä¸€ä¸‹ displayNameã€‚

ðŸŒ»ä¾‹å­ï¼š

```react
const withExample = (Component) => {
  const NewComponent = (props) => {
    return <Component {...props} />;
  }
  
  NewComponent.displayName = `withExample(${Component.displayName || Component.name || 'Component'})`;
  
  return NewCompoennt;
};

```

